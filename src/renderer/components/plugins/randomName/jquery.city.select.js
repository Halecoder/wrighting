!function(e,t){"function"==typeof define?define(["city.select"],t):"object"==typeof exports?module.exports=t():t()}(0,function(){"use strict";return function(e){return e.fn.extend({citylist:function(t){function n(t,n){var d,a,l=t,c=n.data,o=[];let r=l[0].curIndex=Array.isArray(n.selected)?n.selected[0]?n.selected[0]:n.data[0][n.id]:void 0!==n.selected?n.selected:n.data[0][n.id];l[0].showIndex=0;let h=!0;for(var u in c)c.hasOwnProperty(u)&&(void 0!==r&&r==c[u][n.id]&&(d=c[u][n.name],l[0].showIndex=Number(u),h=!1),o.push("<li "+n.metaTag+'="'+c[u][n.id]+'">'+c[u][n.name]+"</li>"));h&&(d=c[0][n.name]),o='<ul class="scrollbar">'+o.join("")+"</ul>",a=`<dl>\n                                <dt>${d}</dt>\n                                <dd>\n                                    <span class="up_btn"></span>\n                                    <span class="down_btn"></span>\n                                </dd>\n                            </dl>`,l.html(a+o),l.off(),l.on("click",function(){let t=l.find("ul");console.log(e(this).offset().top,e(this).height(),t.height()),e(this).offset().top+e(this).height()+t.height()>e(window).height()&&t.addClass("up"),e(t).show(),e(t).find("li").each((t,i)=>{if(e(i).attr(n.metaTag).trim()==l[0].curIndex){e(i).addClass("active").siblings().removeClass("active");let n=e(i);return n.parent().scrollTop(t*n.height()),!1}})}).on("mouseleave",function(){let t=l.find("ul");e(t).hide()}),l.on("click","li",function(){let t=e(this).attr(n.metaTag);return l[0].curIndex=t,l[0].showIndex=e(this).index(),l.find("dt").text(e(this).text()),e(this).parent().hide(),s&&s[0]&&s[0]!==l[0]&&i(n,t,s),!1}),l.on("click",".up_btn",function(){let e=l[0].showIndex=0==l[0].showIndex?c.length-1:l[0].showIndex-1;return l.find("li").eq(e).click(),!1}),l.on("click",".down_btn",function(){console.log(l[0].showIndex);let e=l[0].showIndex=l[0].showIndex==c.length-1?0:l[0].showIndex+1;return console.log(e),l.find("li").eq(e).click(),!1})}function i(t,i,d){var a=t.data.find(e=>e.id==i)[t.children],s=d[0].curIndex=Array.isArray(t.selected)&&t.selected[1]?t.selected[1]:i+"01";n(d,e.extend({id:"id",name:"name",metaTag:t.metaTag,data:!1,selected:!1},{data:a,selected:s}))}let d=e.extend({id:"id",name:"name",children:"children",metaTag:"data-extra",data:!1,selected:!1},t);var a,s,l=e(this);switch(l.length){case 1:n(l,d);break;case 2:!function(e,t){a=e.eq(0),s=e.eq(1),n(a,t),i(t,Array.isArray(t.selected)?t.selected[0]:t.data[0].id,s)}(l,d);break;default:return this}return this}}),e}(jQuery)});